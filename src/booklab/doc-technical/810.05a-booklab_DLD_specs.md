<a id="booklab"></a>

# booklab

**booklab** main python package for Booklab system

Consists of the following basic modules:

- `booklab-cli` which is a CLI application to manage system
- `booklabd` designed to serve `/api/.../` system routes that need database write access

Despite these Python modules, there are other directories in package, the most relevant being:
xy
- `data/` containing the system data in JSON files
- `conf/` containing configuration files for different system components including infrastructure ones like gunicorn or nginx
- `doc-techical/` containing system usage documentation (aka api interface)

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.gunicorn.conf"></a>

# booklab.gunicorn.conf

Configuration file for gunicorn in serving `booklabd` server application

This is a Python file that will be executed by gunicorn at run-time.
As consequence declare all assignements as valid Python code.

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.conf"></a>

# booklab.conf

Cnfigurations component contains various system components configuration files:

- `gunicorn` WSGI web server
- `nginx` local proxy HTTP

Notes / remarks:

- files wirh `.py` extension are considered Python files and can be imported accordingly as longas they are valid Python-code.
- all files from here are assumed to be _text files_. Any deviation from this rule is assumed to be treated accordingly in code.

Author; Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.conf.gunicorn.gunicorn.conf"></a>

# booklab.conf.gunicorn.gunicorn.conf

Configuration file for gunicorn in serving `booklabd` server application

This is a Python file that will be executed by gunicorn at run-time.
As consequence declare all assignements as valid Python code.

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.conf.booklab_ext_url"></a>

# booklab.conf.booklab\_ext\_url

This Python file contains external access URL information.
By external access is understood all URL parts necessary to expose Booklab application:

* EXT_SERVER - the external exposed server name and port if diffrent than standard default (80 or 443) (example: "booklab.mydomain.ro")
* EXT_PATH - the external exposed URL of configured start locations through a LAN main proxy (example: "/booklab/" for a complete external URL like http://booklab.mydomain.ro:5002/booklab/)

_NOTE: all information are of string type_

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.booklib.getBook"></a>

# booklab.booklib.getBook

<a id="booklab.booklib.getBook.getBook"></a>

#### getBook

```python
def getBook(db: pysondb, book_code: str) -> dict | None
```

Check for a given book code:

* test if book code is not None
* test if book code exists in database and is exactly 1 record
* if both conditions return that record as List[Dict]
* if not any condition return None

**Returns**:

  
  * `dict(pysondb)` with found record
  * `None` if any condition is not met

<a id="booklab.booklib"></a>

# booklab.booklib

Module aimed for `booklab` general purpose functions usable across all its (sub)modules.

**Notes**:

- Functions / code defined in this module is agnostic to web application context or CLI application context.
In cases where a context is needed this will be _trasparent_ applied locally, meaning that once exit from that function, previous context is fully restored (no side-effects).

- Some functions could run in background and return control immediatelly after call. These will accept a _callback endpoint_ to be called when finish run.

- Some functions could have a "lazy / delayed" run behavior and these will be accordingly documented to avoid false expectations.

Author: Petre Iordanescu (petre.iordanescu@gnail.com)

<a id="booklab.booklib.db_init"></a>

# booklab.booklib.db\_init

Module that initialize `booklabd` database (more JSON files)

This module is designed to initialize database objects `db_books` and `db_system`.

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.booklib.db_init.init_db"></a>

#### init\_db

```python
def init_db() -> tuple[pysondb]
```

Create db_books, db_system objects and return them as tuple

**Returns**:

  
  `(db_books, db_system)` tuple of pysondb object

<a id="booklab.booklab-cli"></a>

# booklab.booklab-cli

CLI module to assure system operatins as command line.

Architecture; Linux standard (POSIX) CLI

Author; Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.__version__"></a>

# booklab.\_\_version\_\_

**__version__.py** module that contains Booklab aplication version number.

NOTE: this module is imported and made "public" in `booklab._init__.py`

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.booklabd.routes"></a>

# booklab.booklabd.routes

module desined to assure exposion of all `booklabd` interface as HTTP routes

Important variables:

- `booklab.boolabd.api_app`: web application object (aka Flask.app)

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.booklabd.routes.api_newb"></a>

#### api\_newb

```python
@api_app.route("/api/newb/")
def api_newb()
```

serve **newb** book functionality.

Query paraneters: none

<a id="booklab.booklabd.routes.api_bstatus"></a>

#### api\_bstatus

```python
@api_app.route("/api/bstatus/")
def api_bstatus()
```

serve **bstatus** book functionality.

Query paraneters: book code

<a id="booklab.booklabd.routes.api_edtb"></a>

#### api\_edtb

```python
@api_app.route("/api/edtb/")
def api_edtb()
```

serve **edtb** book functionality.

Query paraneters: book code

<a id="booklab.booklabd.routes.api_orgm"></a>

#### api\_orgm

```python
@api_app.route("/api/orgm/")
def api_orgm()
```

serve  **orgm** book functionality.

Query paraneters: book code

<a id="booklab.booklabd.routes.api_prvb"></a>

#### api\_prvb

```python
@api_app.route("/api/prvb/")
def api_prvb()
```

serve **prvb** book functionality.

Query paraneters: book code

<a id="booklab.booklabd.routes.api_dplb"></a>

#### api\_dplb

```python
@api_app.route("/api/dplb/")
def api_dplb()
```

serve **dplb** book functionality.

Query paraneters: book code

<a id="booklab.booklabd.routes.api_bcat"></a>

#### api\_bcat

```python
@api_app.route("/api/bcat/")
def api_bcat()
```

serve accessing books catalog, **bcat** functionality.

<a id="booklab.booklabd.app_init"></a>

# booklab.booklabd.app\_init

**app_init** module that initialize `booklabd` application

This module is designed to initialize the main web application object `api_app`.

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.booklabd.app_init.init_app"></a>

#### init\_app

```python
def init_app(app_name: str, static_site_dir: str, templates_dir: str,
             pjroot_location: str) -> Flask
```

Create Flask application object and return it

**Arguments**:

  
- ``app_name`` - name of web application objwcr
- ``static_site_dir`` - directory used by Flask app to render Jinja templates
- ``templates_dir`` - directory name where templates are to becfound (relative to pjroot_location)
- ``pjroot_location`` - project root directory (relative to pjroot_location)
  

**Returns**:

  
  web application object

<a id="booklab.booklabd"></a>

# booklab.booklabd

booklabd - Booklab API server module

Main functionalities:
* operate & manage JSON database file
* provide necessary http API routes fir book functionalities that need write & dynamic (run-time) behavior

Architecture; HTTP WSGI

Author: Petre Iordanescu (petre.iordanescu@gmail.com)

<a id="booklab.__main__"></a>

# booklab.\_\_main\_\_

... wip ...
modules to be launched at package call with `-m` option

<a id="booklab.data"></a>

# booklab.data

**data** component contains the application database as JSON files:

* a books database (`books_catalog.json`) containing all created books and detailed information about each one
* a system database (`app_info.json`) containing information about installed application

